# shiki Configuration Example
# ============================
# 
# このファイルは shiki の設定例です。
# 実際の環境に合わせて値を変更してください。
#
# 設定ファイルのデフォルトパス: /etc/shiki/config.yaml
# コマンドラインで指定: shiki serve -c /path/to/config.yaml
# 環境変数で指定: SHIKI_CONFIG=/path/to/config.yaml
#
# 詳細は docs/CONFIGURATION.md を参照してください。

# ------------------------------------------------------------------------------
# HTTP サーバー設定
# ------------------------------------------------------------------------------
server:
  # バインドアドレス
  # - "0.0.0.0": すべてのインターフェースでリッスン
  # - "127.0.0.1": ローカルホストのみ
  bind: "0.0.0.0"
  
  # リッスンポート
  port: 8080
  
  # TLS 設定（HTTPS を有効にする場合）
  tls:
    enabled: false
    # cert_path: "/etc/shiki/certs/server.crt"
    # key_path: "/etc/shiki/certs/server.key"

# ------------------------------------------------------------------------------
# 認証設定
# ------------------------------------------------------------------------------
auth:
  # 認証を有効にする場合は true に設定
  # 本番環境では有効化を推奨
  enabled: false
  
  # 認証方式
  # - "token": Bearer トークン認証
  # - "mtls": 相互 TLS 認証（将来実装）
  method: "token"
  
  # Bearer トークン（method: token の場合）
  # セキュリティのため、環境変数 SHIKI_AUTH_TOKEN での指定を推奨
  token: ""

# ------------------------------------------------------------------------------
# ログ設定
# ------------------------------------------------------------------------------
logging:
  # ログレベル: trace, debug, info, warn, error
  level: "info"
  
  # 出力形式
  # - "json": 構造化 JSON（ログ集約システム向け、推奨）
  # - "text": 人間可読なテキスト形式
  format: "json"
  
  # 出力先: stdout, stderr, file
  output: "stdout"
  
  # ファイル出力時のパス（output: file の場合）
  # file_path: "/var/log/shiki/shiki.log"

# ------------------------------------------------------------------------------
# エージェント設定
# ------------------------------------------------------------------------------
agent:
  # エージェント識別名
  # 空の場合はホスト名が使用される
  name: ""
  
  # 動作モード
  # - "standalone": 単独動作（デフォルト）
  # - "cluster": クラスタモード（将来実装）
  mode: "standalone"
  
  # タグ（フィルタリング・識別用）
  tags: []
  # tags:
  #   - "web"
  #   - "production"
  #   - "tokyo-dc"

# ------------------------------------------------------------------------------
# リトライ設定
# ------------------------------------------------------------------------------
retry:
  # 最大リトライ回数
  max_attempts: 3
  
  # 初回リトライ遅延（ミリ秒）
  delay_ms: 1000
  
  # 指数バックオフ係数
  # 遅延 = delay_ms * (backoff_factor ^ 試行回数)
  backoff_factor: 2.0
  
  # 最大リトライ遅延（ミリ秒）
  max_delay_ms: 30000

# ------------------------------------------------------------------------------
# タイムアウト設定
# ------------------------------------------------------------------------------
timeout:
  # TCP 接続タイムアウト（秒）
  connect_seconds: 5
  
  # HTTP レスポンス読み取りタイムアウト（秒）
  read_seconds: 30
  
  # サービス起動/停止待機タイムアウト（秒）
  # 起動に時間がかかるサービスがある場合は増加
  service_seconds: 60

# ------------------------------------------------------------------------------
# サービス制御設定
# ------------------------------------------------------------------------------
services:
  # 許可サービスリスト
  # 空の場合は全サービスが許可される（denied リストを除く）
  # ワイルドカード対応: * (任意の文字列), ? (任意の1文字)
  allowed: []
  # allowed:
  #   - "nginx"
  #   - "postgresql"
  #   - "redis"
  #   - "myapp-*"
  
  # 拒否サービスリスト
  # セキュリティ上重要なサービスは拒否リストに追加推奨
  denied: []
  # denied:
  #   - "sshd"
  #   - "firewalld"
  #   - "systemd-*"

# ------------------------------------------------------------------------------
# クラスタ設定（将来実装）
# ------------------------------------------------------------------------------
cluster:
  enabled: false
  peers: []
  # peers:
  #   - name: "agent-02"
  #     address: "192.168.1.102:8080"
  #   - name: "agent-03"
  #     address: "192.168.1.103:8080"
